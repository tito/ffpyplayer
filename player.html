<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>player &mdash; FFPyPlayer 2.0.0-dev documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0.0-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="FFPyPlayer 2.0.0-dev documentation" href="index.html" />
    <link rel="up" title="The FFPyPlayer API" href="api.html" />
    <link rel="next" title="tools" href="tools.html" />
    <link rel="prev" title="The FFPyPlayer API" href="api.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tools.html" title="tools"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="api.html" title="The FFPyPlayer API"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>

          <li><a href="api.html" accesskey="U">The FFPyPlayer API</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">player</a><ul>
<li><a class="reference internal" href="#module-ffpyplayer.player"><tt class="docutils literal"><span class="pre">ffpyplayer.player</span></tt></a><ul>
<li><a class="reference internal" href="#ffmpeg-based-media-player">FFmpeg based media player</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="api.html"
                        title="previous chapter">The FFPyPlayer API</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tools.html"
                        title="next chapter">tools</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/player.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="player">
<span id="player-api"></span><h1>player<a class="headerlink" href="#player" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-ffpyplayer.player">
<span id="ffpyplayer-player"></span><h2><a class="reference internal" href="#module-ffpyplayer.player" title="ffpyplayer.player"><tt class="xref py py-mod docutils literal"><span class="pre">ffpyplayer.player</span></tt></a><a class="headerlink" href="#module-ffpyplayer.player" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ffmpeg-based-media-player">
<h3>FFmpeg based media player<a class="headerlink" href="#ffmpeg-based-media-player" title="Permalink to this headline">¶</a></h3>
<p>A FFmpeg based python media player. See <a class="reference internal" href="#ffpyplayer.player.MediaPlayer" title="ffpyplayer.player.MediaPlayer"><tt class="xref py py-class docutils literal"><span class="pre">MediaPlayer</span></tt></a> for details.</p>
<dl class="class">
<dt id="ffpyplayer.player.MediaPlayer">
<em class="property">class </em><tt class="descclassname">ffpyplayer.player.</tt><tt class="descname">MediaPlayer</tt><a class="headerlink" href="#ffpyplayer.player.MediaPlayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>MediaPlayer(filename, callback, loglevel=&#8217;error&#8217;, ff_opts={}, thread_lib=&#8217;python&#8217;, audio_sink=&#8217;SDL&#8217;, lib_opts={}, <a href="#id1"><span class="problematic" id="id2">**</span></a>kargs)</p>
<p>An FFmpeg based media player.</p>
<p>Was originally ported from FFplay. Most options offered in FFplay is
also available here.</p>
<p>The class provides a player interface to a media file. Video components
of the file are returned with <a class="reference internal" href="#ffpyplayer.player.MediaPlayer.get_frame" title="ffpyplayer.player.MediaPlayer.get_frame"><tt class="xref py py-meth docutils literal"><span class="pre">get_frame()</span></tt></a>. Audio is played directly
using SDL. And subtitles are acquired either through the callback function
(text subtitles only), or are overlaid directly using the subtitle filter.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><p class="first"><em>filename</em> (str): The filename or url of the media object. This can be
physical files, remote files or even webcam name&#8217;s e.g. for direct show
or Video4Linux webcams. The <em>f</em> specifier in <em>ff_opts</em> can be used to
indicate the format needed to open the file (e.g. dshow).</p>
<p><em>callback</em> (ref to function): A weak ref to a function that will be called
when quitting, when eof is reached (determined by whichever is the <em>sync</em>
stream, audio or video), or when text subtitles are available. The function takes
two parameters, <em>selector</em>, and <em>value</em>.</p>
<p>When the player is closing internally due to some error the <em>selector</em> will be &#8216;quit&#8217;.</p>
<p>When eof is reached the <em>selector</em> will be &#8216;eof&#8217;.</p>
<p>When a new subtitle string is available, <em>selector</em> will be &#8216;display_sub&#8217;
and <em>value</em> will be a 5-tuple of the form <em>(text, fmt, pts, start, end)</em>.
Where <em>text</em> is the text, <em>fmt</em> is the subtitle format e.g. &#8216;ass&#8217;, <em>pts</em>
is the timestamp of the text, <em>start</em>, and <em>end</em> respectively are the times
in video time when to start and finish displaying the text.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This functions gets called from a second internal thread.</p>
</div>
<p><em>loglevel</em> (str): The level of logs to emit. Its value is one of the keywords
defined in <a class="reference internal" href="tools.html#ffpyplayer.tools.loglevels" title="ffpyplayer.tools.loglevels"><tt class="xref py py-attr docutils literal"><span class="pre">ffpyplayer.tools.loglevels</span></tt></a>. Note this only affects
the default FFmpeg logger, which prints to stderr. You can manipulate the
log stream directly using <a class="reference internal" href="tools.html#ffpyplayer.tools.set_log_callback" title="ffpyplayer.tools.set_log_callback"><tt class="xref py py-attr docutils literal"><span class="pre">ffpyplayer.tools.set_log_callback</span></tt></a>.</p>
<p><em>thread_lib</em> (str): The threading library to use internally. Can be one of
&#8216;SDL&#8217; or &#8216;python&#8217;.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the python threading library is used, care must be taken to delete
the player before exiting python, otherwise it may hang. The reason is
that the internal threads are created as non-daemon, consequently, when the
python main thread exits, the internal threads will keep python alive.
By deleting the player directly, the internal threads will be shut down
before python exits.</p>
</div>
<p><em>audio_sink</em> (str): Currently it must be &#8216;SDL&#8217;.</p>
<p><em>lib_opts</em> (dict): A dictionary of options that will be passed to the
ffmpeg libraries, codecs, sws, swr, and formats when opening them. This accepts
most of the options that can be passed to FFplay. Examples are
&#8220;threads&#8221;:&#8221;auto&#8221;, &#8220;lowres&#8221;:&#8221;1&#8221; etc. Both the keywords and values must be
strings.</p>
<p><em>ff_opts</em> (dict): A dictionary with options for the player. Following are
the available options. Note, many options have identical names and meaning
as in the FFplay options: www.ffmpeg.org/ffplay.html</p>
<blockquote class="last">
<div><p><em>cpuflags</em> (str): similar to ffplay</p>
<p><em>max_alloc</em> (int): similar to ffplay</p>
<p><em>infbuf</em> (bool): similar to ffplay, defaults to -1.</p>
<p><em>framedrop</em> (int): similar to ffplay. True if positive, or negative and
<em>sync</em> is not video, otherwise false.</p>
<p><em>loop</em> (int): similar to ffplay, defaults to 1.</p>
<p><em>autoexit</em> (bool): If True, the player closes on eof. Defaults to False.</p>
<p><em>ec</em> (int): similar to ffplay, defaults to 3.</p>
<p><em>lowres</em> (int): similar to ffplay, defaults to zero.</p>
<p><em>drp</em> (int): similar to ffplay.</p>
<p><em>genpts</em> (bool): similar to ffplay, defaults to False.</p>
<p><em>fast</em> (bool): similar to ffplay, defaults to False.</p>
<p><em>bug</em> (bool): similar to ffplay, defaults to True.</p>
<p><em>stats</em> (bool): similar to ffplay, defaults to False.</p>
<p><em>pixel_format</em> (str): similar to ffplay. Note, this sets the format
of the input file. For the output format see <em>out_fmt</em>.</p>
<p><em>bytes</em> (int): similar to ffplay, not used. Defaults to -1.</p>
<p><em>t</em> (float): similar to ffplay, defaults to -1.</p>
<p><em>ss</em> (float): similar to ffplay, defaults to -1.</p>
<p><em>sync</em> (str): similar to ffplay, can be one of &#8216;audio&#8217;, &#8216;video&#8217;, &#8216;ext&#8217;.
Defaults to &#8216;audio&#8217;.</p>
<p><em>acodec, vcodec, scodec</em> (str): similar to ffplay, defaults to None.</p>
<p><em>ast, vst, sst</em> (int): similar to ffplay, defaults to -1.</p>
<p><em>an, sn, vn</em> (bool): similar to ffplay, defaults to False.</p>
<p><em>f</em> (str): similar to ffplay. The format to open the file with. E.g. dshow for webcams.
See <a class="reference internal" href="tools.html#ffpyplayer.tools.list_dshow_devices" title="ffpyplayer.tools.list_dshow_devices"><tt class="xref py py-meth docutils literal"><span class="pre">ffpyplayer.tools.list_dshow_devices()</span></tt></a> for an example. Defaults to None.</p>
<p><em>af, vf</em> (str) similar to ffplay. These are filters applied to the audio/video.
Examples are &#8216;crop=100:100&#8217; to crop, &#8216;vflip&#8217; to flip horizontally, &#8216;subtitles=filename&#8217;
to overlay subtitles from another media or text file etc. CONFIG_AVFILTER must be True
(the default) when compiling in order to use this. Defaults to None.</p>
<p><em>x, y</em> (int): The width and height of the output frames. Similar to
<a class="reference internal" href="#ffpyplayer.player.MediaPlayer.set_size" title="ffpyplayer.player.MediaPlayer.set_size"><tt class="xref py py-meth docutils literal"><span class="pre">set_size()</span></tt></a>. CONFIG_AVFILTER must be True (the default) when
compiling in order to use this. Defaults to 0.</p>
<p><em>use_ref</em> (bool): If True, a refrence to the original data will be returned by
<a class="reference internal" href="#ffpyplayer.player.MediaPlayer.get_frame" title="ffpyplayer.player.MediaPlayer.get_frame"><tt class="xref py py-meth docutils literal"><span class="pre">get_frame()</span></tt></a> instead of a copy.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note, this is not available (MUST be False) if CONFIG_AVFILTER was False
when compiling and the pixel format of the video source is different
than the output format. See <a class="reference internal" href="#ffpyplayer.player.MediaPlayer.get_frame" title="ffpyplayer.player.MediaPlayer.get_frame"><tt class="xref py py-meth docutils literal"><span class="pre">get_frame()</span></tt></a>. Defaults to False.</p>
</div>
<p><em>out_fmt</em> (str): The pixel format of the data returned by <a class="reference internal" href="#ffpyplayer.player.MediaPlayer.get_frame" title="ffpyplayer.player.MediaPlayer.get_frame"><tt class="xref py py-meth docutils literal"><span class="pre">get_frame()</span></tt></a>. Must be
one of <a class="reference internal" href="tools.html#ffpyplayer.tools.pix_fmts" title="ffpyplayer.tools.pix_fmts"><tt class="xref py py-attr docutils literal"><span class="pre">ffpyplayer.tools.pix_fmts</span></tt></a>. Defaults to rgb24.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <em>use_ref</em> is False this must be rgb24.</p>
</div>
</div></blockquote>
</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ffpyplayer.player</span> <span class="kn">import</span> <span class="n">MediaPlayer</span>
<span class="kn">import</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">weakref</span>
<span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">selector</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">selector</span> <span class="o">==</span> <span class="s">&#39;quit&#39;</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;quitting&#39;</span>
<span class="n">player</span> <span class="o">=</span> <span class="n">MediaPlayer</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span>
<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">frame</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s">&#39;eof&#39;</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="k">elif</span> <span class="n">frame</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">val</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">frame</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="tools.html#ffpyplayer.tools.list_dshow_devices" title="ffpyplayer.tools.list_dshow_devices"><tt class="xref py py-meth docutils literal"><span class="pre">ffpyplayer.tools.list_dshow_devices()</span></tt></a> for a more complex example.
See also <a class="reference internal" href="examples.html#examples"><em>Examples</em></a>.</p>
<p>TODO: offer audio buffers, similar to video frames (if wanted?).</p>
<dl class="method">
<dt id="ffpyplayer.player.MediaPlayer.get_frame">
<tt class="descname">get_frame</tt><big>(</big><em>self</em>, <em>force_refresh=False</em>, <em>*args</em><big>)</big><a class="headerlink" href="#ffpyplayer.player.MediaPlayer.get_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the next available frame if ready.</p>
<p>Two types of frames are returned: a single bytes buffer containing the
data in RGBRGB... format if <em>use_ref</em> is False. Otherwise a refrence to the
original frame buffers if <em>use_ref</em> is True, and the buffers can represent
any pixel format. In the former case, the data is copied, while in the
latter case pointers to the original data are retured which <strong>MUST</strong> be freed
by the user after use by calling <a class="reference internal" href="tools.html#ffpyplayer.tools.free_frame_ref" title="ffpyplayer.tools.free_frame_ref"><tt class="xref py py-func docutils literal"><span class="pre">ffpyplayer.tools.free_frame_ref()</span></tt></a>.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><em>force_refresh</em> (bool): If True, the last frame will be returned again.
Note, if returning a frame refrence, each call will return a new refrence.
Defaults to False.</dd>
<dt><strong>Returns</strong>:</dt>
<dd><p class="first"><em>(frame, val)</em>.
<em>frame</em> is None or a 4-tuple.
<em>val</em> is either &#8216;paused&#8217;, &#8216;eof&#8217;, or a float.</p>
<p>If <em>val</em> is either &#8216;paused&#8217; or &#8216;eof&#8217;, <em>frame</em> is None. Otherwise, if
<em>frame</em> is not None, <em>val</em> is the realtime time one should wait before
displaying this frame to the user to achieve a play rate of 1.0.</p>
<p>If <em>frame</em> is not None it&#8217;s a 4-tuple - <em>(buffer, size, linesizes, pts)</em>:</p>
<blockquote class="last">
<div><p><em>buffer</em>: If <em>use_ref</em> is False, it&#8217;s a bytes buffer containing the
frmae in RGBRGB... format. If <em>use_ref</em> is True, it&#8217;s a 3-tuple of
the format <em>(ref, data, format)</em>:</p>
<div class="highlight-python"><pre>*ref* is a refernce to a the frame and is passed to
:func:`ffpyplayer.tools.free_frame_ref` when freeing.

*data* is a 4 element list, where each element is a size_t value
which is char pointer to an array holding the data for this plane,
or 0 (NULL), when the plane has no data.

*format* is the pixel format of the frame in the form of
:attr:`ffpyplayer.tools.pix_fmts`.</pre>
</div>
<p><em>size</em> is a 2-tuple of (width, height) of the frame. Because the video
can be dynamically resized these values can change between frames.</p>
<p><em>linesizes</em> is a 4 element list of the line width of each plane in the frame.
For example, with rgb24, only the first element wil be none-zero
since rgb only has one plane. Typically it should be the same as width multiplied
by the number of bytes in each pixel, however, sometimes it&#8217;s larger due to padding.
If <em>use_ref</em> is False, only the first element will be none-zero, and its
value will be width * 3.</p>
<p><em>pts</em> is the presentation timestamp of this frame. This is the time
when the frame should be displayed to the user in video time (i.e.
not realtime).</p>
</div></blockquote>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The audio plays at a normal play rate, independent of when and if
this function is called. Therefore, &#8216;eof&#8217; will only be received when
the audio is complete, even if all the frames have been read (unless
audio is disabled). I.e. a None frame will be sent after all the frames
have been read until eof.</p>
</div>
<p>For example, playing as soon as frames are read:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">frame</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s">&#39;eof&#39;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">break</span>
<span class="gp">... </span>    <span class="k">elif</span> <span class="n">frame</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&#39;not ready&#39;</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="n">val</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">frame</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">not ready</span>
<span class="go">0.0 1013760 ((704, 480), [2112, 0, 0, 0], 0.0)</span>
<span class="go">0.0 1013760 ((704, 480), [2112, 0, 0, 0], 0.033)</span>
<span class="gp">...</span>
<span class="go">24.731872797 1013760 ((704, 480), [2112, 0, 0, 0], 13.881)</span>
<span class="go">not ready</span>
<span class="go">24.7868728638 1013760 ((704, 480), [2112, 0, 0, 0], 13.914)</span>
</pre></div>
</div>
<p>vs displaying frames at their proper times:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">frame</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s">&#39;eof&#39;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">break</span>
<span class="gp">... </span>    <span class="k">elif</span> <span class="n">frame</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&#39;not ready&#39;</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="n">val</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">frame</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">... </span>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<span class="go">not ready</span>
<span class="go">0.0 1013760 ((704, 480), 2112, 0.0)</span>
<span class="go">0.0 1013760 ((704, 480), 2112, 0.033)</span>
<span class="gp">...</span>
<span class="go">0.031772851944 1013760 ((704, 480), [2112, 0, 0, 0], 20.954)</span>
<span class="go">0.030770778656 1013760 ((704, 480), [2112, 0, 0, 0], 20.988)</span>
<span class="go">0.0307686328888 1013760 ((704, 480), [2112, 0, 0, 0], 21.021)</span>
</pre></div>
</div>
<p>When <em>use_ref</em> is set to True and output format is rgb24:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ffpyplayer.player</span> <span class="kn">import</span> <span class="n">MediaPlayer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ffpyplayer.tools</span> <span class="kn">import</span> <span class="n">free_frame_ref</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">weakref</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">selector</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">selector</span> <span class="o">==</span> <span class="s">&#39;quit&#39;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&#39;quitting&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ff_opts</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;use_ref&#39;</span><span class="p">:</span><span class="bp">True</span><span class="p">,</span> <span class="s">&#39;out_fmt&#39;</span><span class="p">:</span><span class="s">&#39;rgb24&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">player</span> <span class="o">=</span> <span class="n">MediaPlayer</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">callback</span><span class="p">),</span>
<span class="gp">... </span>                     <span class="n">ff_opts</span><span class="o">=</span><span class="n">ff_opts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">frame</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="s">&#39;eof&#39;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">break</span>
<span class="gp">... </span>    <span class="k">elif</span> <span class="n">frame</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="n">val</span><span class="p">,</span> <span class="n">frame</span>
<span class="gp">... </span>        <span class="n">free_frame_ref</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">... </span>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<span class="go">0.0 ((112487968, [124911680, 0, 0, 0], &#39;rgb24&#39;), (1280, 688), [3840, 0, 0, 0], 0.0)</span>
<span class="go">0.0 ((112488480, [146931776, 0, 0, 0], &#39;rgb24&#39;), (1280, 688), [3840, 0, 0, 0], 0.042)</span>
<span class="go">0.0139961242676 ((112488480, [153288768, 0, 0, 0], &#39;rgb24&#39;), (1280, 688), [3840, 0, 0, 0], 0.083)</span>
<span class="go">0.0389950275421 ((112488480, [158728256, 0, 0, 0], &#39;rgb24&#39;), (1280, 688), [3840, 0, 0, 0], 0.125)</span>
<span class="go">0.0759932994843 ((112489536, [124911680, 0, 0, 0], &#39;rgb24&#39;), (1280, 688), [3840, 0, 0, 0], 0.167)</span>
</pre></div>
</div>
<p>Or when <em>use_ref</em> is set to True and output format is yuv420p:</p>
<div class="highlight-python"><pre>...
&gt;&gt;&gt; ff_opts={'use_ref':True, 'out_fmt':'yuv420p'}
...
0.0 ((122377824, [115736640, 111274016, 111527200, 0], 'yuv420p'), (1280, 688),
[1280, 640, 640, 0], 0.042)
0.0179960727692 ((122378848, [114819136, 108882720, 109108704, 0], 'yuv420p'), (1280, 688),
[1280, 640, 640, 0], 0.083)
0.0379951000214 ((122378848, [118947904, 113728128, 113991520, 0], 'yuv420p'), (1280, 688),
[1280, 640, 640, 0], 0.125)
0.0769922733307 ((122379392, [105513024, 66005920, 106430560, 0], 'yuv420p'), (1280, 688),
[1280, 640, 640, 0], 0.167)</pre>
</div>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.player.MediaPlayer.get_metadata">
<tt class="descname">get_metadata</tt><big>(</big><em>self</em><big>)</big><a class="headerlink" href="#ffpyplayer.player.MediaPlayer.get_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns metadata of the file being played.</p>
<dl class="docutils">
<dt><strong>Returns</strong>:</dt>
<dd>(dict): Some player metadata. e.g. frame_rate is reported as a
numerator anddenominator. src and sink video sizes correspond to
the frame size of the original video, and the frames returned by
<a class="reference internal" href="#ffpyplayer.player.MediaPlayer.get_frame" title="ffpyplayer.player.MediaPlayer.get_frame"><tt class="xref py py-meth docutils literal"><span class="pre">get_frame()</span></tt></a>, respectively.</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>
<span class="go">{&#39;duration&#39;: 71.972, &#39;sink_vid_size&#39;: (0, 0), &#39;src_vid_size&#39;:</span>
<span class="go"> (704, 480), &#39;frame_rate&#39;: (13978, 583),</span>
<span class="go"> &#39;title&#39;: &#39;The Melancholy of Haruhi Suzumiya: Special Ending&#39;}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The dictionary returned will have default values until the file is
open and read. Because a second thread is created and used to read
the file, when the constructor returns the dict might still have
the default values. After the first frame is read, the dictionary
entries are correct with respect to the file metadata.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some paramteres can change as the streams are manipulated (e.g. the
frame size parameters).</p>
</div>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.player.MediaPlayer.get_pts">
<tt class="descname">get_pts</tt><big>(</big><em>self</em><big>)</big><a class="headerlink" href="#ffpyplayer.player.MediaPlayer.get_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the elapsed play time.</p>
<dl class="docutils">
<dt><strong>Returns</strong>:</dt>
<dd>(float): The amount of the time that the video has been playing.
The time is from the clock used for the player (default is audio,
see sync option). If the clock is based on video, it should correspond
with the pts from get_frame.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.player.MediaPlayer.get_volume">
<tt class="descname">get_volume</tt><big>(</big><em>self</em><big>)</big><a class="headerlink" href="#ffpyplayer.player.MediaPlayer.get_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the volume of the audio.</p>
<dl class="docutils">
<dt><strong>Returns</strong>:</dt>
<dd>(float): A value between 0.0 - 1.0.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.player.MediaPlayer.request_channel">
<tt class="descname">request_channel</tt><big>(</big><em>self</em>, <em>stream_type</em>, <em>action='cycle'</em>, <em>int requested_stream=-1</em><big>)</big><a class="headerlink" href="#ffpyplayer.player.MediaPlayer.request_channel" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens or closes a stream dynamically.</p>
<p>This function may result in seeking when opening a new stream.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><p class="first"><em>stream_type</em> (str): The stream group on which to operate. Can be one of
&#8216;audio&#8217;, &#8216;video&#8217;, or &#8216;subtitle&#8217;.</p>
<p><em>action</em> (str): The action to preform. Can be one of &#8216;open&#8217;, &#8216;close&#8217;,
or &#8216;cycle&#8217;. A value of &#8216;cycle&#8217; will close the current stream and
open the next stream in this group.</p>
<p class="last"><em>requested_stream</em> (int): The stream to open next when <em>action</em> is
&#8216;cycle&#8217; or &#8216;open&#8217;. If -1, the next stream will be opened. Otherwise,
this stream will be attempted to be opened.</p>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This should only be called from the main thread (the thread that calls
get_frame).</p>
</div>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.player.MediaPlayer.seek">
<tt class="descname">seek</tt><big>(</big><em>self</em>, <em>pts</em>, <em>relative=True</em>, <em>seek_by_bytes=False</em><big>)</big><a class="headerlink" href="#ffpyplayer.player.MediaPlayer.seek" title="Permalink to this definition">¶</a></dt>
<dd><p>Seeks in the current streams.</p>
<p>Seeks to the desired timepoint as close as possible while not exceeding
that time.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><p class="first"><em>pts</em> (float): The timestamp to seek to (in seconds).</p>
<p><em>relative</em> (bool): Whether the pts parameter is interpreted as the
time offset from the current stream position.</p>
<p class="last"><em>seek_by_bytes</em> (bool): Whether we seek based on the position in bytes
or in time. In some instances seeking by bytes may be more accurate
(don&#8217;t ask me which).</p>
</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((1280, 688), [3840, 0, 0, 0], 1016.392)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">player</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mf">200.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((1280, 688), [3840, 0, 0, 0], 1249.876)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">player</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((1280, 688), [3840, 0, 0, 0], 198.49)</span>
</pre></div>
</div>
<p>Note that it may take a few calls to get new frames after seeking.</p>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.player.MediaPlayer.set_size">
<tt class="descname">set_size</tt><big>(</big><em>self</em>, <em>int width=-1</em>, <em>int height=-1</em><big>)</big><a class="headerlink" href="#ffpyplayer.player.MediaPlayer.set_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Dynamically sets the size of the frames returned by get_frame.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><em>width</em>, <em>height</em> (int): The width and height of the output frames.
A value of 0 will set that parameter to the source height/width.
A value of -1 for one of the parameters, will result in a value of that
parameter that maintains the original aspect ratio.</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((704, 480), [2112, 0, 0, 0], 0.067)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">player</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((704, 480), [2112, 0, 0, 0], 0.1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((704, 480), [2112, 0, 0, 0], 0.133)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((704, 480), [2112, 0, 0, 0], 0.167)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((200, 200), [600, 0, 0, 0], 0.2)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">player</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((200, 200), [600, 0, 0, 0], 0.234)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((200, 200), [600, 0, 0, 0], 0.267)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((200, 480), [600, 0, 0, 0], 0.3)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">player</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((200, 480), [600, 0, 0, 0], 0.334)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((200, 480), [600, 0, 0, 0], 0.367)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">player</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
<span class="go">((200, 136), [600, 0, 0, 0], 0.4)</span>
</pre></div>
</div>
<p>Note that it takes a few calls to flush the old frames.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This should only be called from the main thread (the thread that calls
get_frame).</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">if CONFIG_AVFILTER was False when compiling, this function will raise
an error.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.player.MediaPlayer.set_volume">
<tt class="descname">set_volume</tt><big>(</big><em>self</em>, <em>volume</em><big>)</big><a class="headerlink" href="#ffpyplayer.player.MediaPlayer.set_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the volume of the audio.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><em>volume</em> (float): A value between 0.0 - 1.0.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.player.MediaPlayer.toggle_pause">
<tt class="descname">toggle_pause</tt><big>(</big><em>self</em><big>)</big><a class="headerlink" href="#ffpyplayer.player.MediaPlayer.toggle_pause" title="Permalink to this definition">¶</a></dt>
<dd><p>Pauses or unpauses the player.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tools.html" title="tools"
             >next</a> |</li>
        <li class="right" >
          <a href="api.html" title="The FFPyPlayer API"
             >previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>

          <li><a href="api.html" >The FFPyPlayer API</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Matthew Einhorn.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>
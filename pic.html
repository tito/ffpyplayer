<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>picture tools &mdash; FFPyPlayer 3.1-dev documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.1-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="FFPyPlayer 3.1-dev documentation" href="index.html" />
    <link rel="up" title="The FFPyPlayer API" href="api.html" />
    <link rel="next" title="player" href="player.html" />
    <link rel="prev" title="The FFPyPlayer API" href="api.html" /> 
  </head>
  <body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci"/></a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="player.html" title="player"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="api.html" title="The FFPyPlayer API"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>

          <li><a href="api.html" accesskey="U">The FFPyPlayer API</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">picture tools</a><ul>
<li><a class="reference internal" href="#module-ffpyplayer.pic"><tt class="docutils literal"><span class="pre">ffpyplayer.pic</span></tt></a><ul>
<li><a class="reference internal" href="#ffmpeg-based-image-storage-and-conversion-tools">FFmpeg based image storage and conversion tools</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="api.html"
                        title="previous chapter">The FFPyPlayer API</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="player.html"
                        title="next chapter">player</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/pic.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="picture-tools">
<span id="pic-api"></span><h1>picture tools<a class="headerlink" href="#picture-tools" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-ffpyplayer.pic">
<span id="ffpyplayer-pic"></span><h2><a class="reference internal" href="#module-ffpyplayer.pic" title="ffpyplayer.pic"><tt class="xref py py-mod docutils literal"><span class="pre">ffpyplayer.pic</span></tt></a><a class="headerlink" href="#module-ffpyplayer.pic" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ffmpeg-based-image-storage-and-conversion-tools">
<h3>FFmpeg based image storage and conversion tools<a class="headerlink" href="#ffmpeg-based-image-storage-and-conversion-tools" title="Permalink to this headline">¶</a></h3>
<p>FFmpeg based classes to store and convert images from / to many different pixel
formats. See <a class="reference internal" href="#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><tt class="xref py py-class docutils literal"><span class="pre">Image</span></tt></a> and <a class="reference internal" href="#ffpyplayer.pic.SWScale" title="ffpyplayer.pic.SWScale"><tt class="xref py py-class docutils literal"><span class="pre">SWScale</span></tt></a> for details.</p>
<p>Create an image in rgb24 format:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">buf</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">255</span> <span class="o">/</span> <span class="n">size</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">buf</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="n">buf</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">plane_buffers</span><span class="o">=</span><span class="p">[</span><span class="n">buf</span><span class="p">],</span> <span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;rgb24&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
</pre></div>
</div>
<p>Convert the image to a different size:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sws</span> <span class="o">=</span> <span class="n">SWScale</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">(),</span> <span class="n">ow</span><span class="o">=</span><span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">oh</span><span class="o">=</span><span class="n">h</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">sws</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
<span class="go">(250, 33)</span>
</pre></div>
</div>
<p>Convert the image to YUV420P and get the resulting plane buffers as bytearrays:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sws</span> <span class="o">=</span> <span class="n">SWScale</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">(),</span> <span class="n">ofmt</span><span class="o">=</span><span class="s">&#39;yuv420p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">sws</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">()</span>
<span class="go">&#39;yuv420p&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">planes</span> <span class="o">=</span> <span class="n">img2</span><span class="o">.</span><span class="n">to_bytearray</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">planes</span><span class="p">)</span>
<span class="go">[50000, 12500, 12500, 0]</span>
</pre></div>
</div>
<p>Create an Image using default FFmpeg buffers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;rgb24&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
</pre></div>
</div>
<p>Copy the image:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">copy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># copy reference without actually copying the buffers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># do deep copy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
<dl class="class">
<dt id="ffpyplayer.pic.Image">
<em class="property">class </em><tt class="descclassname">ffpyplayer.pic.</tt><tt class="descname">Image</tt><a class="headerlink" href="#ffpyplayer.pic.Image" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Image(plane_buffers=[], plane_ptrs=[], frame=0, pix_fmt=&#8217;&#8216;, size=(), linesize=[], <a href="#id1"><span class="problematic" id="id2">**</span></a>kargs)</p>
<p>Stores a image buffer in a given pixel format.</p>
<p>An Image can be represented by many different pixel formats, which determines
how the buffer representing it is stored. We store the buffers as one to
four arrays of bytes representing the one to four planes. For example,
RGB23 has all the data in the first plane in the form of RGBRGB... while
YUV420P uses the first three planes.</p>
<p>The Image can be initialized with a list of the plane buffers, a reference
to an FFmpeg frame, or internal buffers can be created when none are provided.
Depending on how it&#8217;s initialized one or more params need to be specified.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><p class="first"><em>plane_buffers</em> (list): A list of bytes or bytearray type objects representing the
planes. The number of planes is determined by <em>pix_fmt</em> (e.g. 1 for RGB24,
3 for yuv). The length of the bytes object in each plane is a function
of <em>size</em>, and if provided, also <em>linesize</em>. See <em>linesize</em> for details.
The buffers are used directly without making any copies therefore, the
bytes objects are kept alive internally as long as this instance is alive.</p>
<p><em>plane_ptrs</em> (list): A list of python ints, representing c pointers to the
planes. The number of planes is determined by <em>pix_fmt</em> (e.g. 1 for RGB24,
3 for yuv). The length of the array in each plane is a function of <em>size</em>,
and if provided, also <em>linesize</em>. See <em>linesize</em> for details. The arrays
are used directly without making any copies, therefore, they must remain
valid for as long as this instance is alive. The ints should be size_t
in c and represent uint8_t pointers. This should really only be used
from within Cython.</p>
<p><em>frame</em> (python int): A reference to an FFmpeg internal frame. This should
only be used in Cython. It&#8217;s a pointer to a AVFrame which has been cast
to a size_t. The frame should be a fully initialized frame. None of the
other params need to be specified. The frame is cloned and buffers are
copied if the originals are not reference counted to ensure they remain
valid.</p>
<p><em>pix_fmt</em> (str): The pixel format of the image. Can be one of
<a class="reference internal" href="tools.html#ffpyplayer.tools.pix_fmts" title="ffpyplayer.tools.pix_fmts"><tt class="xref py py-attr docutils literal"><span class="pre">ffpyplayer.tools.pix_fmts</span></tt></a>. Must be provided when using
<em>plane_buffers</em> or <em>plane_ptrs</em>.</p>
<p><em>size</em> (2-tuple): The size of the frame in the form of (width, height).
Must be provided when using <em>plane_buffers</em> or <em>plane_ptrs</em>.</p>
<p class="last"><em>linesize</em> (list): The linesize of each provided plane. In addition to
the width of the frame, a linesize can be provided. The <em>linesize</em> represent
the actual number of bytes in each line, and may be padded at the end
to satisfy some alignment requirement. For example, a RGB24 frame of size
(100, 10) will have 3 * 100 = 300 bytes in each line and will be 3000 bytes
large. But, when 32 bit alignment is required, the buffer will have to
padded at the end so that each line is 320 bytes, and the total buffer
length is 3200 bytes. If <em>linesize</em> is provided, it must be provided for
every valid plane. If it&#8217;s not provided, an alignment of 1 (i.e. no
alignment) is assumed. See <a class="reference internal" href="#ffpyplayer.pic.Image.get_buffer_size" title="ffpyplayer.pic.Image.get_buffer_size"><tt class="xref py py-meth docutils literal"><span class="pre">get_buffer_size()</span></tt></a> for more details.</p>
</dd>
</dl>
<p><strong>Copying</strong></p>
<p>FFmpeg has an internal ref counting system where when used, it frees buffers
it allocated only when there&#8217;s no reference to it remaining thereby allowing
multiple images to use the same buffer without making copies. When the
Image class allocates the image buffers, e.g. when no image is provided,
such reference buffers are created. As a consequence, when copying the Image
object, the buffers may not have to be copied.</p>
<p>Using the python copy module you can do a <strong>shallow</strong> or a <strong>deep</strong> copy of
the object. When doing a <em>shallow</em> copy new buffers will be created if the
original buffers were not FFmpeg created and referenced, e.g. if provided
using <em>plane_buffers</em> or <em>plane_ptrs</em>. This is to ensure the buffers won&#8217;t
go out of memory while in use. After the copy, the buffers will be referenced
and additional copies will create more references without copying the buffers.
A <em>deep</em> copy, however, will always create a new referenced buffer.
The function <a class="reference internal" href="#ffpyplayer.pic.Image.is_ref" title="ffpyplayer.pic.Image.is_ref"><tt class="xref py py-meth docutils literal"><span class="pre">is_ref()</span></tt></a> indicates whether the image buffer is such a
FFmpeg referenced buffer.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">480</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">buf</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">255</span> <span class="o">/</span> <span class="n">size</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">buf</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="n">buf</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">plane_buffers</span><span class="o">=</span><span class="p">[</span><span class="n">buf</span><span class="p">],</span> <span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;rgb24&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;rgb24&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
</pre></div>
</div>
<dl class="method">
<dt id="ffpyplayer.pic.Image.get_buffer_size">
<tt class="descname">get_buffer_size</tt><big>(</big><em>self</em>, <em>keep_align=False</em><big>)</big><a class="headerlink" href="#ffpyplayer.pic.Image.get_buffer_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the size of the buffers of each plane.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><em>keep_align</em> (bool): If True, the linesize alignments of the image
will be used to calculate the buffer size for each plane. If False,
an alignment of 1 (i.e. no alignment) will be used, returning the
minimal buffer size required to store the image. Defaults to False.</dd>
<dt><strong>Returns</strong>:</dt>
<dd>(4-tuple): A list of buffer sizes for each plane of this pixel format.</dd>
</dl>
<p>A (unaligned) yuv420p image has 3 planes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;yuv420p&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(100, 50, 50, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_buffer_size</span><span class="p">()</span>
<span class="go">(1000, 250, 250, 0)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># align to 32 bits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">align</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="mf">32.</span><span class="p">)</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">align</span><span class="p">,</span> <span class="n">linesize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span>
<span class="go">[128, 64, 64, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;yuv420p&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">linesize</span><span class="o">=</span><span class="n">linesize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(128, 64, 64, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_buffer_size</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(1280, 320, 320, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_buffer_size</span><span class="p">()</span>
<span class="go">(1000, 250, 250, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.pic.Image.get_linesizes">
<tt class="descname">get_linesizes</tt><big>(</big><em>self</em>, <em>keep_align=False</em><big>)</big><a class="headerlink" href="#ffpyplayer.pic.Image.get_linesizes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the linesize of each plane.</p>
<p>The linesize is the actual number of bytes in each line for a given plane,
which may be padded at the end to satisfy some alignment requirement.
For example, a RGB24 frame of size (100, 10) will have 3 * 100 = 300
bytes in each line and will be 3000 bytes large. But, when 32 bit
alignment is required, the buffer will have to padded at the end so
that each line is 320 bytes, and the total buffer length is 3200 bytes.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><em>keep_align</em> (bool): If True, the linesize alignments of the image
will be returned for every plane. If False, linesize with an alignment
of 1 (i.e. no alignment) will be used, returning the minimal
linesize required to for the image. Defaults to False.</dd>
<dt><strong>Returns</strong>:</dt>
<dd>(list): The linesizes of each plane.</dd>
</dl>
<p>By defaults there&#8217;s no alignment:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">plane_buffers</span><span class="o">=</span><span class="p">[</span><span class="nb">bytes</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)],</span>
<span class="gp">... </span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;rgb24&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(300, 0, 0, 0)</span>
</pre></div>
</div>
<p>You can force alignment e.g. 32 bits alignment:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mf">32.</span><span class="p">)</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span>
<span class="go">[320]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">plane_buffers</span><span class="o">=</span><span class="p">[</span><span class="nb">bytes</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="n">linesize</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span>
<span class="gp">... </span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;rgb24&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">linesize</span><span class="o">=</span><span class="n">linesize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(320, 0, 0, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
<span class="go">(100, 10)</span>
</pre></div>
</div>
<p>The linesizes of an unaligned and 32 bit aligned yuv420p image:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;yuv420p&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(100, 50, 50, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
<span class="go">(100, 10)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># now try align to 32 bit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">align</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="mf">32.</span><span class="p">)</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">align</span><span class="p">,</span> <span class="n">linesize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span>
<span class="go">[128, 64, 64, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;yuv420p&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">linesize</span><span class="o">=</span><span class="n">linesize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(128, 64, 64, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">()</span>
<span class="go">(100, 50, 50, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
<span class="go">(100, 10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.pic.Image.get_pixel_format">
<tt class="descname">get_pixel_format</tt><big>(</big><em>self</em><big>)</big><a class="headerlink" href="#ffpyplayer.pic.Image.get_pixel_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the pixel format of the image. Can be one of
<a class="reference internal" href="tools.html#ffpyplayer.tools.pix_fmts" title="ffpyplayer.tools.pix_fmts"><tt class="xref py py-attr docutils literal"><span class="pre">ffpyplayer.tools.pix_fmts</span></tt></a>.</p>
<dl class="docutils">
<dt><strong>Returns</strong>:</dt>
<dd>(str): The pixel format of the image</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">()</span>
<span class="go">&#39;rgb24&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.pic.Image.get_size">
<tt class="descname">get_size</tt><big>(</big><em>self</em><big>)</big><a class="headerlink" href="#ffpyplayer.pic.Image.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the size of the frame.</p>
<dl class="docutils">
<dt><strong>Returns</strong>:</dt>
<dd>(2-tuple): The size of the frame as (width, height).</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
<span class="go">(640, 480)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.pic.Image.is_ref">
<tt class="descname">is_ref</tt><big>(</big><em>self</em><big>)</big><a class="headerlink" href="#ffpyplayer.pic.Image.is_ref" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether the image buffer is FFmpeg referenced. This can only be
True when the buffers were allocated internally or by FFmpeg, see
<a class="reference internal" href="#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><tt class="xref py py-class docutils literal"><span class="pre">Image</span></tt></a> for details. After a copy, it will always returns True.</p>
<dl class="docutils">
<dt><strong>Returns</strong>:</dt>
<dd>(bool): True if the buffer is FFmpeg referenced.</dd>
</dl>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">640</span><span class="p">,</span> <span class="mi">480</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">plane_buffers</span><span class="o">=</span><span class="p">[</span><span class="nb">bytes</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)],</span> <span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;rgb24&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">is_ref</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">copy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span><span class="o">.</span><span class="n">is_ref</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Or if directly allocated internally:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;rgb24&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">is_ref</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.pic.Image.to_bytearray">
<tt class="descname">to_bytearray</tt><big>(</big><em>self</em>, <em>keep_align=False</em><big>)</big><a class="headerlink" href="#ffpyplayer.pic.Image.to_bytearray" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the plane buffers as bytearrays.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><em>keep_align</em> (bool): If True, the buffer will be padded after each
horizontal line to match the linesize of this plane. If False, an
alignment of 1 (i.e. no alignment) will be used, returning the
maximially packed buffer of this plane. Defaults to False.</dd>
<dt><strong>Returns</strong>:</dt>
<dd>(4-element list): A list of bytearray buffers for each plane of this
pixel format.</dd>
</dl>
<p>Get the buffer of an RGB image:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;rgb24&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(300, 0, 0, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">to_bytearray</span><span class="p">())</span>
<span class="go">[3000, 0, 0, 0]</span>
</pre></div>
</div>
<p>Get the buffers of a YUV420P image:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;yuv420p&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span>
<span class="go">(100, 50, 50, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">align</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="mf">32.</span><span class="p">)</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">align</span><span class="p">,</span> <span class="n">linesize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span>
<span class="go">[128, 64, 64, 0]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;yuv420p&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="n">linesize</span><span class="o">=</span><span class="n">linesize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">to_bytearray</span><span class="p">())</span>
<span class="go">[1000, 250, 250, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">to_bytearray</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">[1280, 320, 320, 0]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># now initialize a new Image with it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">plane_buffers</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">to_bytearray</span><span class="p">(),</span>
<span class="gp">... </span><span class="n">pix_fmt</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">(),</span> <span class="n">size</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">get_size</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span><span class="o">.</span><span class="n">get_buffer_size</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(1000, 250, 250, 0)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># keep alignment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">plane_buffers</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">to_bytearray</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
<span class="gp">... </span><span class="n">pix_fmt</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">(),</span> <span class="n">size</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">get_size</span><span class="p">(),</span>
<span class="gp">... </span><span class="n">linesize</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span><span class="o">.</span><span class="n">get_buffer_size</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(1280, 320, 320, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ffpyplayer.pic.Image.to_memoryview">
<tt class="descname">to_memoryview</tt><big>(</big><em>self</em>, <em>keep_align=False</em><big>)</big><a class="headerlink" href="#ffpyplayer.pic.Image.to_memoryview" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a memoryviews of the buffers of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><cite>keep_align</cite>: bool</dt>
<dd><p class="first last">If True, the buffers of the original image will be returned
without making any additional copies. If False, then if the
image alignment is already 1, the original buffers will be
returned, otherwise, new buffers will be created with an
alignment of 1 and the buffers will be copied into them
and returned. See <a class="reference internal" href="#ffpyplayer.pic.Image.to_bytearray" title="ffpyplayer.pic.Image.to_bytearray"><tt class="xref py py-meth docutils literal"><span class="pre">to_bytearray()</span></tt></a>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(4-element list): A list of cython arrays for each plane of this
image&#8217;s pixel format. If the data didn&#8217;t have to be copied, the
arrays point directly to the original image data. The arrays
can be used where memoryviews are accepted, since cython arrays
implement the memoryview interface.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the data points to the original image data, you must ensure
that this <a class="reference internal" href="#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><tt class="xref py py-class docutils literal"><span class="pre">Image</span></tt></a> instance does not go out of memory
while the returned arrays are in use. Otherwise when the
<a class="reference internal" href="#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><tt class="xref py py-class docutils literal"><span class="pre">Image</span></tt></a> goes out of memory, the original data will become
invalid and usage of the returned arrays will crash python.</p>
</div>
<p>Get the buffer of an RGB image:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;rgb24&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(300, 0, 0, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span><span class="o">.</span><span class="n">to_memoryview</span><span class="p">()</span>
<span class="go">[&lt;ffpyplayer.pic.array object at 0x055DCE58&gt;, None, None, None]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">to_memoryview</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c"># memview is the only attribute of cython arrays</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">memview</span>
<span class="go">&lt;MemoryView of &#39;array&#39; at 0x55d1468&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">memview</span><span class="o">.</span><span class="n">size</span>
<span class="go">3000</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ffpyplayer.pic.SWScale">
<em class="property">class </em><tt class="descclassname">ffpyplayer.pic.</tt><tt class="descname">SWScale</tt><a class="headerlink" href="#ffpyplayer.pic.SWScale" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>SWScale(int iw, int ih, ifmt, int ow=-1, int oh=-1, ofmt=&#8217;&#8216;, <a href="#id3"><span class="problematic" id="id4">**</span></a>kargs)</p>
<p>Converts Images from one format and size to another format and size.</p>
<p>The class accepts an Image of a given pixel format and size and converts it
to another Image with a different pixel format and size. Each SWScale instance
converts only images with parameters specified when creating the instance.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><p class="first"><em>iw, ih</em> (int): The width and height of the source image.</p>
<p><em>ifmt</em> (str): The pixel format of the source image. Can be one of
<a class="reference internal" href="tools.html#ffpyplayer.tools.pix_fmts" title="ffpyplayer.tools.pix_fmts"><tt class="xref py py-attr docutils literal"><span class="pre">ffpyplayer.tools.pix_fmts</span></tt></a>.</p>
<p><em>ow, oh</em> (int): The width and height of the output image after
converting from the source image. A value of 0 will set that parameter
to the source height/width. A value of -1 for one of the parameters,
will result in a value of that parameter that maintains the original
aspect ratio. Defaults to -1.</p>
<p class="last"><em>ofmt</em> (str): The pixel format of the output image. Can be one of
<a class="reference internal" href="tools.html#ffpyplayer.tools.pix_fmts" title="ffpyplayer.tools.pix_fmts"><tt class="xref py py-attr docutils literal"><span class="pre">ffpyplayer.tools.pix_fmts</span></tt></a>. If empty, the source pixel format
will be used. Defaults to empty string.</p>
</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">buf</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">255</span> <span class="o">/</span> <span class="n">size</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">buf</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="n">buf</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">plane_buffers</span><span class="o">=</span><span class="p">[</span><span class="n">buf</span><span class="p">],</span> <span class="n">pix_fmt</span><span class="o">=</span><span class="s">&#39;rgb24&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># specify output w,h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sws</span> <span class="o">=</span> <span class="n">SWScale</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">(),</span> <span class="n">ow</span><span class="o">=</span><span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">oh</span><span class="o">=</span><span class="n">h</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">sws</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
<span class="go">(250, 33)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># use input height</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sws</span> <span class="o">=</span> <span class="n">SWScale</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">(),</span> <span class="n">ow</span><span class="o">=</span><span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">oh</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">sws</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
<span class="go">(250, 100)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># keep aspect ratio</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sws</span> <span class="o">=</span> <span class="n">SWScale</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">(),</span> <span class="n">ow</span><span class="o">=</span><span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">sws</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span><span class="o">.</span><span class="n">get_size</span><span class="p">()</span>
<span class="go">(250, 50)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># convert rgb24 to yuv420p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sws</span> <span class="o">=</span> <span class="n">SWScale</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">(),</span> <span class="n">ofmt</span><span class="o">=</span><span class="s">&#39;yuv420p&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">sws</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">()</span>
<span class="go">&#39;yuv420p&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c"># convert into a previously allocated and aligned image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">align</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="mf">32.</span><span class="p">)</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">(),</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(750, 0, 0, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">align</span><span class="p">,</span> <span class="n">img2</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linesize</span>
<span class="go">[768, 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">pix_fmt</span><span class="o">=</span><span class="n">img2</span><span class="o">.</span><span class="n">get_pixel_format</span><span class="p">(),</span> <span class="n">size</span><span class="o">=</span><span class="n">img2</span><span class="o">.</span><span class="n">get_size</span><span class="p">(),</span> <span class="n">linesize</span><span class="o">=</span><span class="n">linesize</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span><span class="o">.</span><span class="n">get_linesizes</span><span class="p">(</span><span class="n">keep_align</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(768, 0, 0, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sws</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">img2</span><span class="p">)</span>
<span class="go">&lt;ffpyplayer.pic.Image object at 0x02B44440&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2</span>
<span class="go">&lt;ffpyplayer.pic.Image object at 0x02B44440&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="ffpyplayer.pic.SWScale.scale">
<tt class="descname">scale</tt><big>(</big><em>self</em>, <em>Image src</em>, <em>Image dst=None</em><big>)</big><a class="headerlink" href="#ffpyplayer.pic.SWScale.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Scales a image into another image format and/or size as specified by the
instance initialization parameters.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><p class="first"><em>src</em> (<a class="reference internal" href="#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><tt class="xref py py-class docutils literal"><span class="pre">Image</span></tt></a>): A image instance with values matching the source
image specification of this instance. An exception is raised if the
Image doesn&#8217;t match. It will be used as the source image.</p>
<p class="last"><em>dst</em> (<a class="reference internal" href="#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><tt class="xref py py-class docutils literal"><span class="pre">Image</span></tt></a> or None): A image instance with values matching
the output image specification of this instance. An exception is raised
if the Image doesn&#8217;t match. If specified, the output image will be
converted directly into this Image. If not specified, a new Image
will be created and returned.</p>
</dd>
<dt><strong>Returns</strong>:</dt>
<dd>(<a class="reference internal" href="#ffpyplayer.pic.Image" title="ffpyplayer.pic.Image"><tt class="xref py py-class docutils literal"><span class="pre">Image</span></tt></a>): The output image. If <em>dst</em> was not None <em>dst</em> will
be returned, otherwise a new image containing the converted image
will be returned.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ffpyplayer.pic.get_image_size">
<tt class="descclassname">ffpyplayer.pic.</tt><tt class="descname">get_image_size</tt><big>(</big><em>pix_fmt</em>, <em>width</em>, <em>height</em><big>)</big><a class="headerlink" href="#ffpyplayer.pic.get_image_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the size in bytes of the buffers of each plane of an image with a
given pixel format, width, and height.</p>
<dl class="docutils">
<dt><strong>Args</strong>:</dt>
<dd><p class="first"><em>pix_fmt</em> (str): The pixel format in which the image is represented.
Can be one of <a class="reference internal" href="tools.html#ffpyplayer.tools.pix_fmts" title="ffpyplayer.tools.pix_fmts"><tt class="xref py py-attr docutils literal"><span class="pre">ffpyplayer.tools.pix_fmts</span></tt></a>.</p>
<p class="last"><em>width, height</em> (int): The width and height of the image.</p>
</dd>
<dt><strong>Returns</strong>:</dt>
<dd>(4-tuple): A list of buffer sizes in bytes for each plane of this pixel
format, required to store the image.</dd>
</dl>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">get_image_size</span><span class="p">(</span><span class="s">&#39;rgb24&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="go">(30000, 0, 0, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">get_image_size</span><span class="p">(</span><span class="s">&#39;yuv420p&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="go">(10000, 2500, 2500, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">get_image_size</span><span class="p">(</span><span class="s">&#39;gray&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="go">(10000, 1024, 0, 0)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="player.html" title="player"
             >next</a> |</li>
        <li class="right" >
          <a href="api.html" title="The FFPyPlayer API"
             >previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>

          <li><a href="api.html" >The FFPyPlayer API</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Matthew Einhorn.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>